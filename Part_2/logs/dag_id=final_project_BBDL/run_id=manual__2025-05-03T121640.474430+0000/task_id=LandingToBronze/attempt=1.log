[2025-05-03T12:16:44.842+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-05-03T12:16:45.565+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: final_project_BBDL.LandingToBronze manual__2025-05-03T12:16:40.474430+00:00 [queued]>
[2025-05-03T12:16:45.574+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: final_project_BBDL.LandingToBronze manual__2025-05-03T12:16:40.474430+00:00 [queued]>
[2025-05-03T12:16:45.575+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-05-03T12:16:46.060+0000] {taskinstance.py:2330} INFO - Executing <Task(SparkSubmitOperator): LandingToBronze> on 2025-05-03 12:16:40.474430+00:00
[2025-05-03T12:16:46.068+0000] {standard_task_runner.py:63} INFO - Started process 6899 to run task
[2025-05-03T12:16:46.073+0000] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'final_project_BBDL', 'LandingToBronze', 'manual__2025-05-03T12:16:40.474430+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/project_solution.py', '--cfg-path', '/tmp/tmpjomzftsc']
[2025-05-03T12:16:46.076+0000] {standard_task_runner.py:91} INFO - Job 35: Subtask LandingToBronze
[2025-05-03T12:16:46.521+0000] {logging_mixin.py:188} WARNING - /home/airflow/.local/lib/python3.10/site-packages/airflow/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-05-03T12:16:46.629+0000] {task_command.py:426} INFO - Running <TaskInstance: final_project_BBDL.LandingToBronze manual__2025-05-03T12:16:40.474430+00:00 [running]> on host 6ca5a7f6558e
[2025-05-03T12:16:47.408+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='final_project_BBDL' AIRFLOW_CTX_TASK_ID='LandingToBronze' AIRFLOW_CTX_EXECUTION_DATE='2025-05-03T12:16:40.474430+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-03T12:16:40.474430+00:00'
[2025-05-03T12:16:47.409+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-05-03T12:16:48.229+0000] {base.py:84} INFO - Using connection ID 'spark_default' for task execution.
[2025-05-03T12:16:48.230+0000] {spark_submit.py:328} ERROR - Failed to decode base64 keytab: Invalid base64-encoded string: number of data characters (5) cannot be 1 more than a multiple of 4
[2025-05-03T12:16:48.230+0000] {spark_submit.py:305} INFO - Could not load connection string spark_default, defaulting to spark://spark-master:7077
[2025-05-03T12:16:48.231+0000] {spark_submit.py:474} INFO - Spark-Submit cmd: spark-submit --master spark://spark-master:7077 --conf spark.master=spark://spark-master:7077 --name LandingToBronze --verbose --queue root.default --deploy-mode client /opt/airflow/dags/landing_to_bronze.py
[2025-05-03T12:17:28.652+0000] {spark_submit.py:644} INFO - Using properties file: null
[2025-05-03T12:17:28.871+0000] {spark_submit.py:644} INFO - Parsed arguments:
[2025-05-03T12:17:28.872+0000] {spark_submit.py:644} INFO - master                  spark://spark-master:7077
[2025-05-03T12:17:28.872+0000] {spark_submit.py:644} INFO - deployMode              client
[2025-05-03T12:17:28.872+0000] {spark_submit.py:644} INFO - executorMemory          null
[2025-05-03T12:17:28.872+0000] {spark_submit.py:644} INFO - executorCores           null
[2025-05-03T12:17:28.872+0000] {spark_submit.py:644} INFO - totalExecutorCores      null
[2025-05-03T12:17:28.872+0000] {spark_submit.py:644} INFO - propertiesFile          null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - driverMemory            null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - driverCores             null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - driverExtraClassPath    null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - driverExtraLibraryPath  null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - driverExtraJavaOptions  null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - supervise               false
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - queue                   root.default
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - numExecutors            null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - files                   null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - pyFiles                 null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - archives                null
[2025-05-03T12:17:28.873+0000] {spark_submit.py:644} INFO - mainClass               null
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - primaryResource         file:/opt/airflow/dags/landing_to_bronze.py
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - name                    LandingToBronze
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - childArgs               []
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - jars                    null
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - packages                null
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - packagesExclusions      null
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - repositories            null
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - verbose                 true
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:28.874+0000] {spark_submit.py:644} INFO - Spark properties used, including those specified through
[2025-05-03T12:17:28.875+0000] {spark_submit.py:644} INFO - --conf and those from the properties file null:
[2025-05-03T12:17:28.875+0000] {spark_submit.py:644} INFO - (spark.master,spark://spark-master:7077)
[2025-05-03T12:17:28.875+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:28.875+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:29.749+0000] {spark_submit.py:644} INFO - Main class:
[2025-05-03T12:17:29.749+0000] {spark_submit.py:644} INFO - org.apache.spark.deploy.PythonRunner
[2025-05-03T12:17:29.750+0000] {spark_submit.py:644} INFO - Arguments:
[2025-05-03T12:17:29.750+0000] {spark_submit.py:644} INFO - file:/opt/airflow/dags/landing_to_bronze.py
[2025-05-03T12:17:29.750+0000] {spark_submit.py:644} INFO - null
[2025-05-03T12:17:29.752+0000] {spark_submit.py:644} INFO - Spark config:
[2025-05-03T12:17:29.753+0000] {spark_submit.py:644} INFO - (spark.app.name,LandingToBronze)
[2025-05-03T12:17:29.753+0000] {spark_submit.py:644} INFO - (spark.app.submitTime,1746274649731)
[2025-05-03T12:17:29.753+0000] {spark_submit.py:644} INFO - (spark.master,spark://spark-master:7077)
[2025-05-03T12:17:29.753+0000] {spark_submit.py:644} INFO - (spark.submit.deployMode,client)
[2025-05-03T12:17:29.753+0000] {spark_submit.py:644} INFO - (spark.submit.pyFiles,)
[2025-05-03T12:17:29.753+0000] {spark_submit.py:644} INFO - Classpath elements:
[2025-05-03T12:17:29.754+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:29.754+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:29.754+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:34.970+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:34 INFO SparkContext: Running Spark version 3.3.0
[2025-05-03T12:17:35.167+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-05-03T12:17:35.416+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO ResourceUtils: ==============================================================
[2025-05-03T12:17:35.417+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO ResourceUtils: No custom resources configured for spark.driver.
[2025-05-03T12:17:35.417+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO ResourceUtils: ==============================================================
[2025-05-03T12:17:35.417+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO SparkContext: Submitted application: LandingToBronze
[2025-05-03T12:17:35.461+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
[2025-05-03T12:17:35.468+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO ResourceProfile: Limiting resource is cpu
[2025-05-03T12:17:35.468+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO ResourceProfileManager: Added ResourceProfile id: 0
[2025-05-03T12:17:35.636+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO SecurityManager: Changing view acls to: airflow
[2025-05-03T12:17:35.636+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO SecurityManager: Changing modify acls to: airflow
[2025-05-03T12:17:35.637+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO SecurityManager: Changing view acls groups to:
[2025-05-03T12:17:35.637+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO SecurityManager: Changing modify acls groups to:
[2025-05-03T12:17:35.638+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:35 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(airflow); groups with view permissions: Set(); users  with modify permissions: Set(airflow); groups with modify permissions: Set()
[2025-05-03T12:17:36.194+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO Utils: Successfully started service 'sparkDriver' on port 34541.
[2025-05-03T12:17:36.316+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO SparkEnv: Registering MapOutputTracker
[2025-05-03T12:17:36.362+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO SparkEnv: Registering BlockManagerMaster
[2025-05-03T12:17:36.401+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[2025-05-03T12:17:36.402+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
[2025-05-03T12:17:36.415+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
[2025-05-03T12:17:36.494+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-d0759507-09b3-40a8-b4a7-6392eb407517
[2025-05-03T12:17:36.528+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
[2025-05-03T12:17:36.558+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:36 INFO SparkEnv: Registering OutputCommitCoordinator
[2025-05-03T12:17:37.053+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO Utils: Successfully started service 'SparkUI' on port 4040.
[2025-05-03T12:17:37.282+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
[2025-05-03T12:17:37.345+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO TransportClientFactory: Successfully created connection to spark-master/172.19.0.2:7077 after 28 ms (0 ms spent in bootstraps)
[2025-05-03T12:17:37.468+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20250503121737-0012
[2025-05-03T12:17:37.471+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20250503121737-0012/0 on worker-20250502201254-172.19.0.5-36485 (172.19.0.5:36485) with 2 core(s)
[2025-05-03T12:17:37.473+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO StandaloneSchedulerBackend: Granted executor ID app-20250503121737-0012/0 on hostPort 172.19.0.5:36485 with 2 core(s), 1024.0 MiB RAM
[2025-05-03T12:17:37.478+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38345.
[2025-05-03T12:17:37.478+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO NettyBlockTransferService: Server created on 6ca5a7f6558e:38345
[2025-05-03T12:17:37.481+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2025-05-03T12:17:37.495+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 6ca5a7f6558e, 38345, None)
[2025-05-03T12:17:37.498+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO BlockManagerMasterEndpoint: Registering block manager 6ca5a7f6558e:38345 with 434.4 MiB RAM, BlockManagerId(driver, 6ca5a7f6558e, 38345, None)
[2025-05-03T12:17:37.501+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 6ca5a7f6558e, 38345, None)
[2025-05-03T12:17:37.502+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 6ca5a7f6558e, 38345, None)
[2025-05-03T12:17:37.596+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20250503121737-0012/0 is now RUNNING
[2025-05-03T12:17:37.847+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:37 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[2025-05-03T12:17:38.413+0000] {spark_submit.py:644} INFO - 2025-05-03 12:17:38,413 [INFO] 📁 Директорія гарантовано існує: /tmp/spark_data/landing
[2025-05-03T12:17:38.413+0000] {spark_submit.py:644} INFO - 2025-05-03 12:17:38,413 [INFO] 📁 Директорія гарантовано існує: /tmp/spark_data/bronze
[2025-05-03T12:17:38.414+0000] {spark_submit.py:644} INFO - 2025-05-03 12:17:38,413 [INFO] 📥 Завантаження: https://ftp.goit.study/neoversity/athlete_bio.csv
[2025-05-03T12:17:41.146+0000] {spark_submit.py:644} INFO - 2025-05-03 12:17:41,145 [INFO] ✅ CSV збережено: /tmp/spark_data/landing/athlete_bio.csv
[2025-05-03T12:17:41.147+0000] {spark_submit.py:644} INFO - 2025-05-03 12:17:41,147 [INFO] 📊 Обробка файлу: /tmp/spark_data/landing/athlete_bio.csv
[2025-05-03T12:17:41.749+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:41 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
[2025-05-03T12:17:41.772+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:41 INFO SharedState: Warehouse path is 'file:/opt/airflow/spark-warehouse'.
[2025-05-03T12:17:43.812+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:43 INFO InMemoryFileIndex: It took 50 ms to list leaf files for 1 paths.
[2025-05-03T12:17:43.999+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:43 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
[2025-05-03T12:17:47.024+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO FileSourceStrategy: Pushed Filters:
[2025-05-03T12:17:47.026+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
[2025-05-03T12:17:47.028+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
[2025-05-03T12:17:47.169+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.19.0.5:43866) with ID 0,  ResourceProfileId 0
[2025-05-03T12:17:47.275+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO BlockManagerMasterEndpoint: Registering block manager 172.19.0.5:35719 with 366.3 MiB RAM, BlockManagerId(0, 172.19.0.5, 35719, None)
[2025-05-03T12:17:47.544+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO CodeGenerator: Code generated in 174.460698 ms
[2025-05-03T12:17:47.610+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.2 KiB, free 434.2 MiB)
[2025-05-03T12:17:47.708+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 33.9 KiB, free 434.2 MiB)
[2025-05-03T12:17:47.715+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 6ca5a7f6558e:38345 (size: 33.9 KiB, free: 434.4 MiB)
[2025-05-03T12:17:47.718+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:47.726+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO FileSourceScanExec: Planning scan with bin packing, max size: 29844437 bytes, open cost is considered as scanning 4194304 bytes.
[2025-05-03T12:17:47.830+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:47.842+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2025-05-03T12:17:47.842+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
[2025-05-03T12:17:47.843+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO DAGScheduler: Parents of final stage: List()
[2025-05-03T12:17:47.844+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO DAGScheduler: Missing parents: List()
[2025-05-03T12:17:47.847+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
[2025-05-03T12:17:47.903+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.8 KiB, free 434.2 MiB)
[2025-05-03T12:17:47.911+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 434.2 MiB)
[2025-05-03T12:17:47.911+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 6ca5a7f6558e:38345 (size: 5.9 KiB, free: 434.4 MiB)
[2025-05-03T12:17:47.912+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
[2025-05-03T12:17:47.923+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2025-05-03T12:17:47.924+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[2025-05-03T12:17:47.951+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:47 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.19.0.5, executor 0, partition 0, PROCESS_LOCAL, 4921 bytes) taskResourceAssignments Map()
[2025-05-03T12:17:48.617+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:48 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.19.0.5:35719 (size: 5.9 KiB, free: 366.3 MiB)
[2025-05-03T12:17:51.050+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.19.0.5:35719 (size: 33.9 KiB, free: 366.3 MiB)
[2025-05-03T12:17:51.474+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 3530 ms on 172.19.0.5 (executor 0) (1/1)
[2025-05-03T12:17:51.475+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool
[2025-05-03T12:17:51.484+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 3.624 s
[2025-05-03T12:17:51.487+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-05-03T12:17:51.487+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
[2025-05-03T12:17:51.489+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 3.658124 s
[2025-05-03T12:17:51.507+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO CodeGenerator: Code generated in 9.711057 ms
[2025-05-03T12:17:51.569+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceStrategy: Pushed Filters:
[2025-05-03T12:17:51.569+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceStrategy: Post-Scan Filters:
[2025-05-03T12:17:51.570+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
[2025-05-03T12:17:51.577+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.2 KiB, free 434.0 MiB)
[2025-05-03T12:17:51.591+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 33.9 KiB, free 433.9 MiB)
[2025-05-03T12:17:51.596+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 6ca5a7f6558e:38345 (size: 33.9 KiB, free: 434.3 MiB)
[2025-05-03T12:17:51.597+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:51.598+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceScanExec: Planning scan with bin packing, max size: 29844437 bytes, open cost is considered as scanning 4194304 bytes.
[2025-05-03T12:17:51.657+0000] {spark_submit.py:644} INFO - root
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- athlete_id: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- name: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- sex: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- born: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- height: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- weight: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- country: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- country_noc: string (nullable = true)
[2025-05-03T12:17:51.658+0000] {spark_submit.py:644} INFO - |-- description: string (nullable = true)
[2025-05-03T12:17:51.659+0000] {spark_submit.py:644} INFO - |-- special_notes: string (nullable = true)
[2025-05-03T12:17:51.659+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:51.693+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceStrategy: Pushed Filters:
[2025-05-03T12:17:51.693+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceStrategy: Post-Scan Filters:
[2025-05-03T12:17:51.693+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceStrategy: Output Data Schema: struct<athlete_id: string, name: string, sex: string, born: string, height: string ... 8 more fields>
[2025-05-03T12:17:51.715+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 199.1 KiB, free 433.7 MiB)
[2025-05-03T12:17:51.726+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 33.9 KiB, free 433.7 MiB)
[2025-05-03T12:17:51.727+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 6ca5a7f6558e:38345 (size: 33.9 KiB, free: 434.3 MiB)
[2025-05-03T12:17:51.728+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO SparkContext: Created broadcast 3 from showString at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:51.732+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO FileSourceScanExec: Planning scan with bin packing, max size: 29844437 bytes, open cost is considered as scanning 4194304 bytes.
[2025-05-03T12:17:51.741+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:51.742+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Got job 1 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2025-05-03T12:17:51.742+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Final stage: ResultStage 1 (showString at NativeMethodAccessorImpl.java:0)
[2025-05-03T12:17:51.743+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Parents of final stage: List()
[2025-05-03T12:17:51.743+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Missing parents: List()
[2025-05-03T12:17:51.744+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[12] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
[2025-05-03T12:17:51.759+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 11.1 KiB, free 433.7 MiB)
[2025-05-03T12:17:51.766+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 433.7 MiB)
[2025-05-03T12:17:51.773+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 6ca5a7f6558e:38345 (size: 5.9 KiB, free: 434.3 MiB)
[2025-05-03T12:17:51.773+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
[2025-05-03T12:17:51.775+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[12] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2025-05-03T12:17:51.775+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
[2025-05-03T12:17:51.777+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.19.0.5, executor 0, partition 0, PROCESS_LOCAL, 4921 bytes) taskResourceAssignments Map()
[2025-05-03T12:17:51.819+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.19.0.5:35719 (size: 5.9 KiB, free: 366.3 MiB)
[2025-05-03T12:17:51.961+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:51 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.19.0.5:35719 (size: 33.9 KiB, free: 366.2 MiB)
[2025-05-03T12:17:52.135+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 359 ms on 172.19.0.5 (executor 0) (1/1)
[2025-05-03T12:17:52.136+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool
[2025-05-03T12:17:52.137+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: ResultStage 1 (showString at NativeMethodAccessorImpl.java:0) finished in 0.391 s
[2025-05-03T12:17:52.137+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-05-03T12:17:52.137+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
[2025-05-03T12:17:52.138+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Job 1 finished: showString at NativeMethodAccessorImpl.java:0, took 0.397062 s
[2025-05-03T12:17:52.177+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO CodeGenerator: Code generated in 25.930494 ms
[2025-05-03T12:17:52.220+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 6ca5a7f6558e:38345 in memory (size: 5.9 KiB, free: 434.3 MiB)
[2025-05-03T12:17:52.235+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.19.0.5:35719 in memory (size: 5.9 KiB, free: 366.2 MiB)
[2025-05-03T12:17:52.247+0000] {spark_submit.py:644} INFO - +----------+------------------+------+----------------+------+------+-------------------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
[2025-05-03T12:17:52.247+0000] {spark_submit.py:644} INFO - |athlete_id|name              |sex   |born            |height|weight|country            |country_noc|description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |special_notes                                                                                                                   |
[2025-05-03T12:17:52.248+0000] {spark_submit.py:644} INFO - +----------+------------------+------+----------------+------+------+-------------------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
[2025-05-03T12:17:52.248+0000] {spark_submit.py:644} INFO - |65649     |Ivanka Bonova     |Female|4 April 1949    |166   |55    | Bulgaria          |BUL        |Personal Best: 400 – 53.54 (1980).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |null                                                                                                                            |
[2025-05-03T12:17:52.248+0000] {spark_submit.py:644} INFO - |112510    |Nataliya Uryadova |Female|15 March 1977   |184   |70    | Russian Federation|RUS        |null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |Listed in Olympians Who Won a Medal at the European Beach Volleyball Championships (1–0–0 2006 Den Haag gold)                   |
[2025-05-03T12:17:52.248+0000] {spark_submit.py:644} INFO - |114973    |Essa Ismail Rashed|Male  |14 December 1986|165   |55    | Qatar             |QAT        |Personal Best: 10000 – 27:20.97 (2006).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |Listed in Olympians Who Won a Medal at the Asian Games (0–2–0 2006 Doha ATH silver: 10000 m; 2010 Guangzhou ATH silver: 10000 m)|
[2025-05-03T12:17:52.248+0000] {spark_submit.py:644} INFO - |30359     |Péter Boros       |Male  |12 January 1908 |null  |null  | Hungary           |HUN        |Between 1927 and 1938, Péter Boros competed as a gymnast of BBTE. He won the Hungarian championship in rope climbing in 1932, and as part of the winning team in 1932, 1937 and 1938. As a member of the Hungarian national team, he took part in the 1930 World Championships and the 1932 Olympics both times finishing fourth in the team event. In individual events, he took two 5th places (pommelled horse and rope climbing). After the Olympics due to a series of injuries he did not regain his old form. After completing his career, he worked as a paper merchant.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |null                                                                                                                            |
[2025-05-03T12:17:52.249+0000] {spark_submit.py:644} INFO - |50557     |Rudolf Piowatý    |Male  |28 April 1900   |null  |null  | Czechoslovakia    |TCH        |Rudolf Piowaty joined the Czechoslovak military near the end of World War I, and began his full-time military service in October 1921, leading to his career as a military officer. He also became a top swimmer while in the Army and won his first Czechoslovak title in 1921. He continued to win national titles over the next few years, allowing him to compete at the 1924 Paris Olympics. During World War II Piowaty left occupied Czechoslovakia in July 1942, and made his way to Germany, near Lake Constance. He used his swimming prowess to get to Switzerland, swimming across the lake. Piowaty settled in Genève where he worked for the League of Nations in the Office of the Permanent Delegation to the Czechoslovak Republic. After the liberation of France, Piowaty was sent across that country to Great Britain where he served in the Czechoslovak reserves as a lieutenant and became interim commander of his company. He returned to Czechoslovakia on 14 November 1945 and was awarded the Czechoslovak Military Medal of Merit, 2nd degree, and the Czechoslovak Military Commemorative Medal, after which he was transferred to the reserves permanently. After the Communist takeover Piowaty left his home country in 1948 to settle in Canada where he worked in the furniture trade and leisure and tourism.|null                                                                                                                            |
[2025-05-03T12:17:52.249+0000] {spark_submit.py:644} INFO - +----------+------------------+------+----------------+------+------+-------------------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
[2025-05-03T12:17:52.249+0000] {spark_submit.py:644} INFO - only showing top 5 rows
[2025-05-03T12:17:52.249+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:52.259+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 6ca5a7f6558e:38345 in memory (size: 5.9 KiB, free: 434.3 MiB)
[2025-05-03T12:17:52.261+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.19.0.5:35719 in memory (size: 5.9 KiB, free: 366.2 MiB)
[2025-05-03T12:17:52.318+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileSourceStrategy: Pushed Filters:
[2025-05-03T12:17:52.319+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileSourceStrategy: Post-Scan Filters:
[2025-05-03T12:17:52.319+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileSourceStrategy: Output Data Schema: struct<athlete_id: string, name: string, sex: string, born: string, height: string ... 8 more fields>
[2025-05-03T12:17:52.389+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[2025-05-03T12:17:52.442+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
[2025-05-03T12:17:52.442+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
[2025-05-03T12:17:52.444+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[2025-05-03T12:17:52.445+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
[2025-05-03T12:17:52.445+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
[2025-05-03T12:17:52.446+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[2025-05-03T12:17:52.501+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 199.1 KiB, free 433.5 MiB)
[2025-05-03T12:17:52.512+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 33.9 KiB, free 433.5 MiB)
[2025-05-03T12:17:52.514+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 6ca5a7f6558e:38345 (size: 33.9 KiB, free: 434.3 MiB)
[2025-05-03T12:17:52.515+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO SparkContext: Created broadcast 5 from parquet at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:52.517+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO FileSourceScanExec: Planning scan with bin packing, max size: 29844437 bytes, open cost is considered as scanning 4194304 bytes.
[2025-05-03T12:17:52.548+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
[2025-05-03T12:17:52.550+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
[2025-05-03T12:17:52.550+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Final stage: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0)
[2025-05-03T12:17:52.551+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Parents of final stage: List()
[2025-05-03T12:17:52.551+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Missing parents: List()
[2025-05-03T12:17:52.551+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[14] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
[2025-05-03T12:17:52.566+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 211.9 KiB, free 433.3 MiB)
[2025-05-03T12:17:52.571+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 76.3 KiB, free 433.2 MiB)
[2025-05-03T12:17:52.573+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 6ca5a7f6558e:38345 (size: 76.3 KiB, free: 434.2 MiB)
[2025-05-03T12:17:52.574+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
[2025-05-03T12:17:52.574+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 2 (MapPartitionsRDD[14] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
[2025-05-03T12:17:52.575+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
[2025-05-03T12:17:52.577+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 2) (172.19.0.5, executor 0, partition 0, PROCESS_LOCAL, 4921 bytes) taskResourceAssignments Map()
[2025-05-03T12:17:52.577+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 3) (172.19.0.5, executor 0, partition 1, PROCESS_LOCAL, 4921 bytes) taskResourceAssignments Map()
[2025-05-03T12:17:52.598+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:52 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.19.0.5:35719 (size: 76.3 KiB, free: 366.2 MiB)
[2025-05-03T12:17:53.010+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:53 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.19.0.5:35719 (size: 33.9 KiB, free: 366.1 MiB)
[2025-05-03T12:17:55.878+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 2) in 3301 ms on 172.19.0.5 (executor 0) (1/2)
[2025-05-03T12:17:55.878+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 3) in 3301 ms on 172.19.0.5 (executor 0) (2/2)
[2025-05-03T12:17:55.878+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool
[2025-05-03T12:17:55.880+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO DAGScheduler: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0) finished in 3.327 s
[2025-05-03T12:17:55.880+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
[2025-05-03T12:17:55.881+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
[2025-05-03T12:17:55.881+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 3.332595 s
[2025-05-03T12:17:55.882+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 INFO FileFormatWriter: Start to commit write Job ceea6ada-1f88-4702-9cb6-ee1b11044072.
[2025-05-03T12:17:55.964+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 ERROR FileFormatWriter: Aborting job ceea6ada-1f88-4702-9cb6-ee1b11044072.
[2025-05-03T12:17:55.964+0000] {spark_submit.py:644} INFO - java.io.IOException: Failed to rename DeprecatedRawLocalFileStatus{path=file:/tmp/spark_data/bronze/athlete_bio_v2/_temporary/0/task_202505031217521260367131484425788_0002_m_000000/part-00000-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet; isDirectory=false; length=14730968; replication=1; blocksize=33554432; modification_time=1746274675832; access_time=1746274673381; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false} to file:/tmp/spark_data/bronze/athlete_bio_v2/part-00000-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.mergePaths(FileOutputCommitter.java:477)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.mergePaths(FileOutputCommitter.java:490)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:405)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.parquet.hadoop.ParquetOutputCommitter.commitJob(ParquetOutputCommitter.java:48)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$write$25(FileFormatWriter.scala:267)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:642)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:267)
[2025-05-03T12:17:55.965+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:186)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:98)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:109)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:94)
[2025-05-03T12:17:55.966+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:584)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:584)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:560)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:94)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:81)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:79)
[2025-05-03T12:17:55.967+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:116)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:860)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:390)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:363)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:239)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:793)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at java.base/java.lang.reflect.Method.invoke(Method.java:569)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at py4j.Gateway.invoke(Gateway.java:282)
[2025-05-03T12:17:55.968+0000] {spark_submit.py:644} INFO - at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[2025-05-03T12:17:55.969+0000] {spark_submit.py:644} INFO - at py4j.commands.CallCommand.execute(CallCommand.java:79)
[2025-05-03T12:17:55.969+0000] {spark_submit.py:644} INFO - at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
[2025-05-03T12:17:55.969+0000] {spark_submit.py:644} INFO - at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
[2025-05-03T12:17:55.969+0000] {spark_submit.py:644} INFO - at java.base/java.lang.Thread.run(Thread.java:840)
[2025-05-03T12:17:55.985+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 WARN FileUtil: Failed to delete file or dir [/tmp/spark_data/bronze/athlete_bio_v2/_temporary/0/task_202505031217521260367131484425788_0002_m_000000/.part-00000-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet.crc]: it still exists.
[2025-05-03T12:17:55.986+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 WARN FileUtil: Failed to delete file or dir [/tmp/spark_data/bronze/athlete_bio_v2/_temporary/0/task_202505031217521260367131484425788_0002_m_000000/part-00000-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet]: it still exists.
[2025-05-03T12:17:55.986+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 WARN FileUtil: Failed to delete file or dir [/tmp/spark_data/bronze/athlete_bio_v2/_temporary/0/task_202505031217527823955945742568069_0002_m_000001/.part-00001-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet.crc]: it still exists.
[2025-05-03T12:17:55.986+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:55 WARN FileUtil: Failed to delete file or dir [/tmp/spark_data/bronze/athlete_bio_v2/_temporary/0/task_202505031217527823955945742568069_0002_m_000001/part-00001-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet]: it still exists.
[2025-05-03T12:17:56.021+0000] {spark_submit.py:644} INFO - Traceback (most recent call last):
[2025-05-03T12:17:56.021+0000] {spark_submit.py:644} INFO - File "/opt/airflow/dags/landing_to_bronze.py", line 66, in <module>
[2025-05-03T12:17:56.021+0000] {spark_submit.py:644} INFO - main()
[2025-05-03T12:17:56.021+0000] {spark_submit.py:644} INFO - File "/opt/airflow/dags/landing_to_bronze.py", line 61, in main
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - process_table(spark, table, landing_dir, bronze_dir)
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - File "/opt/airflow/dags/landing_to_bronze.py", line 48, in process_table
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - df.write.mode("overwrite").parquet(bronze_path)
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - File "/home/airflow/.local/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/sql/readwriter.py", line 1140, in parquet
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - File "/home/airflow/.local/lib/python3.10/site-packages/pyspark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - File "/home/airflow/.local/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 190, in deco
[2025-05-03T12:17:56.022+0000] {spark_submit.py:644} INFO - File "/home/airflow/.local/lib/python3.10/site-packages/pyspark/python/lib/py4j-0.10.9.5-src.zip/py4j/protocol.py", line 326, in get_return_value
[2025-05-03T12:17:56.023+0000] {spark_submit.py:644} INFO - py4j.protocol.Py4JJavaError: An error occurred while calling o31.parquet.
[2025-05-03T12:17:56.023+0000] {spark_submit.py:644} INFO - : org.apache.spark.SparkException: Job aborted.
[2025-05-03T12:17:56.023+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.errors.QueryExecutionErrors$.jobAbortedError(QueryExecutionErrors.scala:638)
[2025-05-03T12:17:56.023+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:278)
[2025-05-03T12:17:56.023+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:186)
[2025-05-03T12:17:56.024+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
[2025-05-03T12:17:56.024+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
[2025-05-03T12:17:56.024+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
[2025-05-03T12:17:56.024+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:98)
[2025-05-03T12:17:56.024+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:109)
[2025-05-03T12:17:56.024+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:94)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:584)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:584)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
[2025-05-03T12:17:56.025+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:560)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:94)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:81)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:79)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:116)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:860)
[2025-05-03T12:17:56.026+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:390)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:363)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:239)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:793)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at java.base/java.lang.reflect.Method.invoke(Method.java:569)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at py4j.Gateway.invoke(Gateway.java:282)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[2025-05-03T12:17:56.027+0000] {spark_submit.py:644} INFO - at py4j.commands.CallCommand.execute(CallCommand.java:79)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at java.base/java.lang.Thread.run(Thread.java:840)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - Caused by: java.io.IOException: Failed to rename DeprecatedRawLocalFileStatus{path=file:/tmp/spark_data/bronze/athlete_bio_v2/_temporary/0/task_202505031217521260367131484425788_0002_m_000000/part-00000-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet; isDirectory=false; length=14730968; replication=1; blocksize=33554432; modification_time=1746274675832; access_time=1746274673381; owner=; group=; permission=rw-rw-rw-; isSymlink=false; hasAcl=false; isEncrypted=false; isErasureCoded=false} to file:/tmp/spark_data/bronze/athlete_bio_v2/part-00000-91adf45b-77fe-4368-89ac-27b3b6ebbc68-c000.snappy.parquet
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.mergePaths(FileOutputCommitter.java:477)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.mergePaths(FileOutputCommitter.java:490)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:405)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.parquet.hadoop.ParquetOutputCommitter.commitJob(ParquetOutputCommitter.java:48)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$write$25(FileFormatWriter.scala:267)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
[2025-05-03T12:17:56.028+0000] {spark_submit.py:644} INFO - at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:642)
[2025-05-03T12:17:56.029+0000] {spark_submit.py:644} INFO - at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:267)
[2025-05-03T12:17:56.029+0000] {spark_submit.py:644} INFO - ... 42 more
[2025-05-03T12:17:56.029+0000] {spark_submit.py:644} INFO - 
[2025-05-03T12:17:56.029+0000] {spark_submit.py:644} INFO - 2025-05-03 12:17:56,022 [INFO] Closing down clientserver connection
[2025-05-03T12:17:56.194+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO SparkContext: Invoking stop() from shutdown hook
[2025-05-03T12:17:56.249+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO SparkUI: Stopped Spark web UI at http://6ca5a7f6558e:4040
[2025-05-03T12:17:56.253+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO StandaloneSchedulerBackend: Shutting down all executors
[2025-05-03T12:17:56.254+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
[2025-05-03T12:17:56.273+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
[2025-05-03T12:17:56.303+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO MemoryStore: MemoryStore cleared
[2025-05-03T12:17:56.304+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO BlockManager: BlockManager stopped
[2025-05-03T12:17:56.307+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO BlockManagerMaster: BlockManagerMaster stopped
[2025-05-03T12:17:56.309+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
[2025-05-03T12:17:56.321+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO SparkContext: Successfully stopped SparkContext
[2025-05-03T12:17:56.322+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO ShutdownHookManager: Shutdown hook called
[2025-05-03T12:17:56.322+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO ShutdownHookManager: Deleting directory /tmp/spark-9ec4fa7d-77ef-4474-b48f-7e9e36117b02
[2025-05-03T12:17:56.326+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO ShutdownHookManager: Deleting directory /tmp/spark-caaec261-a01e-40da-b74d-8b651f201764/pyspark-81a3c09c-519b-4858-8564-e3a97baeb00f
[2025-05-03T12:17:56.330+0000] {spark_submit.py:644} INFO - 25/05/03 12:17:56 INFO ShutdownHookManager: Deleting directory /tmp/spark-caaec261-a01e-40da-b74d-8b651f201764
[2025-05-03T12:17:56.371+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-05-03T12:17:56.414+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/providers/apache/spark/operators/spark_submit.py", line 197, in execute
    self._hook.submit(self.application)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/providers/apache/spark/hooks/spark_submit.py", line 566, in submit
    raise AirflowException(
airflow.exceptions.AirflowException: Cannot execute: spark-submit --master spark://spark-master:7077 --conf spark.master=spark://spark-master:7077 --name LandingToBronze --verbose --queue root.default --deploy-mode client /opt/airflow/dags/landing_to_bronze.py. Error code is: 1.
[2025-05-03T12:17:56.494+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=final_project_BBDL, task_id=LandingToBronze, run_id=manual__2025-05-03T12:16:40.474430+00:00, execution_date=20250503T121640, start_date=20250503T121645, end_date=20250503T121756
[2025-05-03T12:17:56.683+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 35 for task LandingToBronze (Cannot execute: spark-submit --master spark://spark-master:7077 --conf spark.master=spark://spark-master:7077 --name LandingToBronze --verbose --queue root.default --deploy-mode client /opt/airflow/dags/landing_to_bronze.py. Error code is: 1.; 6899)
[2025-05-03T12:17:56.726+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-05-03T12:17:56.772+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-05-03T12:17:56.824+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
